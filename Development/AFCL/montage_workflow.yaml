---
name: "montage_workflow"
dataIns:
- name: "bucket"
  type: "string"
  source: "bucket"
- name: "header"
  type: "string"
  source: "header"
workflowBody:
- function:
    name: "preparemProjectPP"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "montage_workflow/bucket"
    - name: "header"
      type: "string"
      source: "montage_workflow/header"
    dataOuts:
    - name: "filenames"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:preparemProjectPP"
- parallelFor:
    name: "mProjectPPs"
    dataIns:
    - name: "filename"
      type: "string"
      source: "preparemProjectPP/filenames"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemProjectPP/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemProjectPP/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemProjectPP/number"
      step: "1"
    loopBody:
    - function:
        name: "mProjectPP"
        type: "Collection"
        dataIns:
        - name: "filename"
          type: "string"
          source: "mProjectPPs/filename"
        - name: "bucket"
          type: "string"
          source: "mProjectPPs/bucket"
        - name: "header"
          type: "string"
          source: "mProjectPPs/header"
        properties:
        - name: "resource"
          value: "arn:aws:lambda:us-east-1:609751656607:function:m_ProjectPP"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mProjectPPs/bucket"
    - name: "header"
      type: "string"
      source: "mProjectPPs/header"
- function:
    name: "preparemDiffFit"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mProjectPPs/bucket"
    - name: "header"
      type: "string"
      source: "mProjectPPs/header"
    dataOuts:
    - name: "diff_rows"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:preparemDiffFit"
- parallelFor:
    name: "mDiffFits"
    dataIns:
    - name: "diff"
      type: "string"
      source: "preparemDiffFit/diff_rows"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemDiffFit/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemDiffFit/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemDiffFit/number"
      step: "1"
    loopBody:
    - function:
        name: "mDiffFit"
        type: "Collection"
        dataIns:
        - name: "diff"
          type: "string"
          source: "mDiffFits/diff"
        - name: "bucket"
          type: "string"
          source: "mDiffFits/bucket"
        - name: "header"
          type: "string"
          source: "mDiffFits/header"
        properties:
        - name: "resource"
          value: "arn:aws:lambda:us-east-1:609751656607:function:m_DiffFit"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mDiffFits/bucket"
    - name: "header"
      type: "string"
      source: "mDiffFits/header"
- function:
    name: "mConcatFit"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mDiffFits/bucket"
    - name: "header"
      type: "string"
      source: "mDiffFits/header"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_ConcatFit"
- function:
    name: "mBgModel"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mConcatFit/bucket"
    - name: "header"
      type: "string"
      source: "mConcatFit/header"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_BgModel"
- function:
    name: "preparemBackground"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mBgModel/bucket"
    - name: "header"
      type: "string"
      source: "mBgModel/header"
    dataOuts:
    - name: "filenames"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:preparemBackground"
- parallelFor:
    name: "mBackgrounds"
    dataIns:
    - name: "filename"
      type: "string"
      source: "preparemBackground/filenames"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemBackground/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemBackground/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemBackground/number"
      step: "1"
    loopBody:
    - function:
        name: "mBackground"
        type: "Collection"
        dataIns:
        - name: "filename"
          type: "string"
          source: "mBackgrounds/filename"
        - name: "bucket"
          type: "string"
          source: "mBackgrounds/bucket"
        properties:
        - name: "resource"
          value: "arn:aws:lambda:us-east-1:609751656607:function:m_Background"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mBackgrounds/bucket"
    - name: "header"
      type: "string"
      source: "mBackgrounds/header"
- function:
    name: "mImgtbl"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mBackgrounds/bucket"
    - name: "header"
      type: "string"
      source: "mBackgrounds/header"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_Imgtbl"
- function:
    name: "mAdd"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mImgtbl/bucket"
    - name: "header"
      type: "string"
      source: "mImgtbl/header"
    dataOuts:
    - name: "bucket"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_Add"
- function:
    name: "mShrink"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mAdd/bucket"
    dataOuts:
    - name: "bucket"
      type: "string"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_Shrink"
- function:
    name: "mViewer"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mShrink/bucket"
    properties:
    - name: "resource"
      value: "arn:aws:lambda:us-east-1:609751656607:function:m_Viewer"
